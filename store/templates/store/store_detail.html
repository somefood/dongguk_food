{% extends "base.html" %}
{% load static %}
{% block extra-style %}
<style>
    .store-body {
        height: 1000px;
    }
    .store-body-description {
        height: 250px;
    }
    .carousel-image {
        filter: brightness(50%);
    }

</style>
{% endblock %}
{% block content %}
<div class="row store-header">
    <div class="col-sm-4">
        <h1 class="mt-3">{{ store.name }}</h1>
    </div>
    <div class="col-sm-7">
        <button id="store_like" class="btn btn-outline-primary">좋아요</button>
    </div>
</div>
<hr>
<div class="row store-body">
    <div class="col-sm-11 store-body-description">
        {{ store.description }}
    </div>
    <div class="col-md-7">
        <table class="table">
            <tbody>
            <tr>
                <th style="width: 20%;">주소</th>
                <td>{{store.location}}</td>
            </tr>
            <tr>
                <th>연락처</th>
                <td>{{store.phone_number}}</td>
            </tr>
            <tr>
                <th>영업시간</th>
                <td>{{store.running_time}}</td>
            </tr>
            <tr>
                <th>메뉴</th>
                <td>
                {% for menu in store.menu_set.all %}
                {{menu.name}}<br>
                {% endfor %}
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="col-md-7">
        <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
                {% for menu in store.menu_set.all %}
                    {% ifequal forloop.counter0 0 %}
                        <li data-target="#carouselExampleCaptions" data-slide-to="{{ forloop.counter0 }}" class="active"></li>
                    {% else %}
                        <li data-target="#carouselExampleCaptions" data-slide-to="{{ forloop.counter0 }}"></li>
                    {% endifequal %}
                {% endfor %}
            </ol>
            <div class="carousel-inner">
                {% for menu in store.menu_set.all %}
                <div class="carousel-item">
                    <img src="{% if menu.food_image %}{{ menu.food_image.url }}{% else %}{% static 'img/alt_image.png' %}{% endif %}" class="d-block w-100 carousel-image" alt="">
                    <div class="carousel-caption d-none d-md-block">
                        <section>
                            <h5>{{ menu.name }}</h5>
                            <p>{{ menu.description }}</p>
                        </section>
                    </div>
                </div>
                {% endfor %}
            </div>
            <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
</div>
<hr>
{% if user.is_staff %}
<button class="btn btn-primary" onclick="location.href='{% url 'store:edit' store.pk %}'">수정</button>
<button class="btn btn-primary" onclick="location.href='{% url 'store:delete' store.pk %}'">삭제</button>
<button class="btn btn-primary" onclick="showPopup();">삭제</button>
{% endif %}

<div class="row mt-3 store-footer">
    <div class="col-md-7">
        <div>
            <b>TAGS</b> <i class="fas fa-tag"></i>
            {% load taggit_templatetags2_tags %}
            {% get_tags_for_object object as "tags" %}
            {% for tag in tags %}
            <a href="{% url 'helpers:tagged_object_list' tag.name %}">{{tag.name}}</a>
            {% endfor %}
            &emsp;
            <a href="{% url 'helpers:tag_cloud' %}"><span class="btn btn-info btn-sm">TagCloud</span></a>
        </div>
        <br>
        <div id="disqus_thread"></div>
    </div>
</div>
{% endblock %}
{% block extra-script %}
<script>
    $(document).ready(function(){
       $('.carousel-item:first-child').addClass('active');
    });

    var disqus_config = function () {
    this.page.identifier = '{{ disqus_id }}'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    this.page.url = '{{ disqus_url }}';  // Replace PAGE_URL with your page's canonical URL variable
    this.page.title = '{{ disqus_title }}'
};

(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://{{ disqus_short }}.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</script>
{% endblock %}